<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://tbnpg.settlebank.co.kr/resources/js/SettlePG.js"></script>
    <title>커피와케이크</title>
</head>
<body>
    <ul id="showProductName"></ul>
    <input type="button" value="수량선택" onclick="openBuyPopUp()">
    <ul id="selectCountArea"></ul>
    <div id="buttonsArea"></div>
    <input type="hidden" id="test" value="abc">
   
  
    <script src="/lib/js/jslib.js"></script>
<script>
var itemArray;
var result;
var items=[];
var selectitem=[];
window.onload=function(){
    getFood('food','coffee');
}
function getFood(bigkind,kind) {
    var requestUrl="http://localhost:8080/api/getItems?bigkind="+bigkind+"&kind="+kind;
    result=fisrtRequest(requestUrl,null);
    console.log(result);
    var itmes=result.itmes;
    for(var i=0;i<itmes.length;i++){
        $('#showProductName').append("<li>"+itmes[i].productName+"<input type='checkbox' class='item' value='"+itmes[i].productName+"'></li>");
    }  
}
function selectItmes() {
    var obj_length = document.getElementsByClassName("item").length;
    for (var i=0; i<obj_length; i++) {
        if (document.getElementsByClassName("item")[i].checked == true) {
            selectitem[selectitem.length]=document.getElementsByClassName("item")[i].value;
        }
    }
}
function openBuyPopUp() {
    selectItmes();
    var openWin;
    openWin = window.open("buyFoodPopUP.html","buyFoodPopUP", "width=570, height=350, resizable = no, scrollbars = no");  


    /*for(var i=0;i<selectitem.length;i++){
        $('#selectCountArea').append("<li class='selectItem'>"+selectitem[i]+"<input type='number' id='"+selectitem[i]+"count' min='1'></li>");
    }*/
   
}
function getSelectItems() {
    return selectitem;
}
function buy() {
    makeItemCountOhter();
}
function makeItemCountOhter(){
    //var array=make2DArray(selectTime.length,2);
    //for(var i=0;i<array.length;i++){
        //array[i][0]=selectSeat;
       // array[i][1]=1;
    //}
    itemArray=[['아메리카노-s',3],['아메리카노-m',1]];

}
function requestCard() {
    buy();
    var requestUrl='http://localhost:8080/api/getSha256Hash';
    let data=JSON.stringify({
         "mchtId":"nxca_jt_il",
         "kind":"food",
         "method":"card",
         "productNameAndCount":itemArray
	});
	result=fisrtRequest(requestUrl,data);
    console.log(result);
    if(result.bool){
        var trdDt=result.trdDt;
        var trdTm=result.trdTm;
        var trdAmt=result.trdAmt;
        var mchtTrdNo=result.mchtTrdNo;
        var pktHash=result.pktHash;
        var itemName="아메리카노 ";
        var mchtCustId=result.mchtCustId;
        card(trdDt,trdTm,mchtTrdNo,itemName,trdAmt,mchtCustId,pktHash);
    }else{
        alert(result.messege);
    }
}
 </script>   
</body>
</html>